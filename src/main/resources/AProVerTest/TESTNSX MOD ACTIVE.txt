simulating Needham_SchroederX.asm
INFO - parsing file C:\Users\gioeg\AProVerDirectory\Aprover\src\main\resources\AProVerTest\Needham_SchroederX.asm
INFO - file successfully parsed for asm Needham_SchroederX
Running interactively Needham_SchroederX.asm
INITIAL STATE:Alice={agentA}
Bob={agentB}
Eve={agentE}
Insert a symbol of Receiver in [AG_A, AG_B, AG_E] for chosenReceiver:
AG_B
Insert a symbol of Modality in [ACTIVE, PASSIVE] for chosenMode:
ACTIVE
<State 0 (monitored)>
chosenMode=ACTIVE
chosenReceiver=AG_B
</State 0 (monitored)>
<UpdateSet - 0>
asymEnc(NAK,1,1,2)=PUBKB
internalStateA(agentA)=WAITING_NNK
messageField(agentA,agentE,1,NAK)=NA
messageField(agentA,agentE,2,NAK)=ID_A
protocolMessage(agentA,agentE)=NAK
</UpdateSet>
<State 1 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
asymEnc(NAK,1,1,2)=PUBKB
internalStateA(agentA)=WAITING_NNK
internalStateB(agentB)=WAITING_NAK
messageField(agentA,agentE,1,NAK)=NA
messageField(agentA,agentE,2,NAK)=ID_A
mode=ACTIVE
protocolMessage(agentA,agentE)=NAK
protocolMessage(agentB,agentE)=undef
protocolMessage(agentE,agentA)=undef
protocolMessage(agentE,agentB)=undef
receiver=AG_B
</State 1 (controlled)>
<UpdateSet - 1>
asymEnc(NAK,1,1,2)=PUBKB
messageField(agentE,agentB,1,NAK)=NA
messageField(agentE,agentB,2,NAK)=ID_A
protocolMessage(agentE,agentB)=NAK
</UpdateSet>
<State 2 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
asymEnc(NAK,1,1,2)=PUBKB
internalStateA(agentA)=WAITING_NNK
internalStateB(agentB)=WAITING_NAK
knowsAsymPrivKey(agentE,PRIVKB)=false
messageField(agentA,agentE,1,NAK)=NA
messageField(agentA,agentE,2,NAK)=ID_A
messageField(agentE,agentB,1,NAK)=NA
messageField(agentE,agentB,2,NAK)=ID_A
mode=ACTIVE
protocolMessage(agentA,agentE)=NAK
protocolMessage(agentB,agentE)=undef
protocolMessage(agentE,agentA)=undef
protocolMessage(agentE,agentB)=NAK
receiver=AG_B
</State 2 (controlled)>
<UpdateSet - 2>
asymEnc(NNK,1,1,2)=PUBKA
internalStateB(agentB)=WAITING_NK
knowsIdentityCertificate(agentB,ID_A)=true
knowsNonce(agentB,NA)=true
messageField(agentB,agentE,1,NNK)=NA
messageField(agentB,agentE,2,NNK)=NB
protocolMessage(agentB,agentE)=NNK
</UpdateSet>
<State 3 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
asymEnc(NAK,1,1,2)=PUBKB
asymEnc(NNK,1,1,2)=PUBKA
internalStateA(agentA)=WAITING_NNK
internalStateB(agentB)=WAITING_NK
knowsAsymPrivKey(agentB,PRIVKB)=true
knowsAsymPrivKey(agentE,PRIVKB)=false
knowsIdentityCertificate(agentB,ID_A)=true
knowsNonce(agentB,NA)=true
messageField(agentA,agentE,1,NAK)=NA
messageField(agentA,agentE,2,NAK)=ID_A
messageField(agentB,agentE,1,NNK)=NA
messageField(agentB,agentE,2,NNK)=NB
messageField(agentE,agentB,1,NAK)=NA
messageField(agentE,agentB,2,NAK)=ID_A
mode=ACTIVE
protocolMessage(agentA,agentE)=NAK
protocolMessage(agentB,agentE)=NNK
protocolMessage(agentE,agentA)=undef
protocolMessage(agentE,agentB)=NAK
receiver=AG_B
</State 3 (controlled)>
<UpdateSet - 3>
asymEnc(NNK,1,1,2)=PUBKA
messageField(agentE,agentA,1,NAK)=NA
messageField(agentE,agentA,2,NAK)=NB
protocolMessage(agentE,agentA)=NNK
</UpdateSet>
<State 4 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
asymEnc(NAK,1,1,2)=PUBKB
asymEnc(NNK,1,1,2)=PUBKA
internalStateA(agentA)=WAITING_NNK
internalStateB(agentB)=WAITING_NK
knowsAsymPrivKey(agentB,PRIVKB)=true
knowsAsymPrivKey(agentE,PRIVKA)=false
knowsAsymPrivKey(agentE,PRIVKB)=false
knowsIdentityCertificate(agentB,ID_A)=true
knowsNonce(agentB,NA)=true
messageField(agentA,agentE,1,NAK)=NA
messageField(agentA,agentE,2,NAK)=ID_A
messageField(agentB,agentE,1,NNK)=NA
messageField(agentB,agentE,2,NNK)=NB
messageField(agentE,agentA,1,NAK)=NA
messageField(agentE,agentA,2,NAK)=NB
messageField(agentE,agentB,1,NAK)=NA
messageField(agentE,agentB,2,NAK)=ID_A
mode=ACTIVE
protocolMessage(agentA,agentE)=NAK
protocolMessage(agentB,agentE)=NNK
protocolMessage(agentE,agentA)=NNK
protocolMessage(agentE,agentB)=NAK
receiver=AG_B
</State 4 (controlled)>
<UpdateSet - 4>
asymEnc(NK,1,1,1)=PUBKB
internalStateA(agentA)=END_A
knowsNonce(agentA,NA)=true
knowsNonce(agentA,NB)=true
messageField(agentA,agentE,1,NK)=undef
protocolMessage(agentA,agentE)=NK
</UpdateSet>
<State 5 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
asymEnc(NAK,1,1,2)=PUBKB
asymEnc(NK,1,1,1)=PUBKB
asymEnc(NNK,1,1,2)=PUBKA
internalStateA(agentA)=END_A
internalStateB(agentB)=WAITING_NK
knowsAsymPrivKey(agentA,PRIVKA)=true
knowsAsymPrivKey(agentB,PRIVKB)=true
knowsAsymPrivKey(agentE,PRIVKA)=false
knowsAsymPrivKey(agentE,PRIVKB)=false
knowsIdentityCertificate(agentB,ID_A)=true
knowsNonce(agentA,NA)=true
knowsNonce(agentA,NB)=true
knowsNonce(agentB,NA)=true
messageField(agentA,agentE,1,NAK)=NA
messageField(agentA,agentE,1,NK)=undef
messageField(agentA,agentE,2,NAK)=ID_A
messageField(agentB,agentE,1,NNK)=NA
messageField(agentB,agentE,2,NNK)=NB
messageField(agentE,agentA,1,NAK)=NA
messageField(agentE,agentA,2,NAK)=NB
messageField(agentE,agentA,2,NNK)=undef
messageField(agentE,agentB,1,NAK)=NA
messageField(agentE,agentB,2,NAK)=ID_A
mode=ACTIVE
protocolMessage(agentA,agentE)=NK
protocolMessage(agentB,agentE)=NNK
protocolMessage(agentE,agentA)=NNK
protocolMessage(agentE,agentB)=NAK
receiver=AG_B
</State 5 (controlled)>
<UpdateSet - 5>
asymEnc(NK,1,1,1)=PUBKB
messageField(agentE,agentB,1,NAK)=undef
protocolMessage(agentE,agentB)=NK
</UpdateSet>
<State 6 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
asymEnc(NAK,1,1,2)=PUBKB
asymEnc(NK,1,1,1)=PUBKB
asymEnc(NNK,1,1,2)=PUBKA
internalStateA(agentA)=END_A
internalStateB(agentB)=WAITING_NK
knowsAsymPrivKey(agentA,PRIVKA)=true
knowsAsymPrivKey(agentB,PRIVKB)=true
knowsAsymPrivKey(agentE,PRIVKA)=false
knowsAsymPrivKey(agentE,PRIVKB)=false
knowsIdentityCertificate(agentB,ID_A)=true
knowsNonce(agentA,NA)=true
knowsNonce(agentA,NB)=true
knowsNonce(agentB,NA)=true
messageField(agentA,agentE,1,NAK)=NA
messageField(agentA,agentE,1,NK)=undef
messageField(agentA,agentE,2,NAK)=ID_A
messageField(agentB,agentE,1,NNK)=NA
messageField(agentB,agentE,2,NNK)=NB
messageField(agentE,agentA,1,NAK)=NA
messageField(agentE,agentA,2,NAK)=NB
messageField(agentE,agentA,2,NNK)=undef
messageField(agentE,agentB,1,NAK)=undef
messageField(agentE,agentB,2,NAK)=ID_A
mode=ACTIVE
protocolMessage(agentA,agentE)=NK
protocolMessage(agentB,agentE)=NNK
protocolMessage(agentE,agentA)=NNK
protocolMessage(agentE,agentB)=NK
receiver=AG_B
</State 6 (controlled)>
<UpdateSet - 6>
internalStateB(agentB)=END_B
</UpdateSet>
<State 7 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
asymEnc(NAK,1,1,2)=PUBKB
asymEnc(NK,1,1,1)=PUBKB
asymEnc(NNK,1,1,2)=PUBKA
internalStateA(agentA)=END_A
internalStateB(agentB)=END_B
knowsAsymPrivKey(agentA,PRIVKA)=true
knowsAsymPrivKey(agentB,PRIVKB)=true
knowsAsymPrivKey(agentE,PRIVKA)=false
knowsAsymPrivKey(agentE,PRIVKB)=false
knowsIdentityCertificate(agentB,ID_A)=true
knowsNonce(agentA,NA)=true
knowsNonce(agentA,NB)=true
knowsNonce(agentB,NA)=true
messageField(agentA,agentE,1,NAK)=NA
messageField(agentA,agentE,1,NK)=undef
messageField(agentA,agentE,2,NAK)=ID_A
messageField(agentB,agentE,1,NNK)=NA
messageField(agentB,agentE,2,NNK)=NB
messageField(agentE,agentA,1,NAK)=NA
messageField(agentE,agentA,2,NAK)=NB
messageField(agentE,agentA,2,NNK)=undef
messageField(agentE,agentB,1,NAK)=undef
messageField(agentE,agentB,2,NAK)=ID_A
mode=ACTIVE
protocolMessage(agentA,agentE)=NK
protocolMessage(agentB,agentE)=NNK
protocolMessage(agentE,agentA)=NNK
protocolMessage(agentE,agentB)=NK
receiver=AG_B
</State 7 (controlled)>
<UpdateSet - 7>
</UpdateSet>
<State 8 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
asymEnc(NAK,1,1,2)=PUBKB
asymEnc(NK,1,1,1)=PUBKB
asymEnc(NNK,1,1,2)=PUBKA
internalStateA(agentA)=END_A
internalStateB(agentB)=END_B
knowsAsymPrivKey(agentA,PRIVKA)=true
knowsAsymPrivKey(agentB,PRIVKB)=true
knowsAsymPrivKey(agentE,PRIVKA)=false
knowsAsymPrivKey(agentE,PRIVKB)=false
knowsIdentityCertificate(agentB,ID_A)=true
knowsNonce(agentA,NA)=true
knowsNonce(agentA,NB)=true
knowsNonce(agentB,NA)=true
messageField(agentA,agentE,1,NAK)=NA
messageField(agentA,agentE,1,NK)=undef
messageField(agentA,agentE,2,NAK)=ID_A
messageField(agentB,agentE,1,NNK)=NA
messageField(agentB,agentE,2,NNK)=NB
messageField(agentE,agentA,1,NAK)=NA
messageField(agentE,agentA,2,NAK)=NB
messageField(agentE,agentA,2,NNK)=undef
messageField(agentE,agentB,1,NAK)=undef
messageField(agentE,agentB,2,NAK)=ID_A
mode=ACTIVE
protocolMessage(agentA,agentE)=NK
protocolMessage(agentB,agentE)=NNK
protocolMessage(agentE,agentA)=NNK
protocolMessage(agentE,agentB)=NK
receiver=AG_B
</State 8 (controlled)>
FINAL STATE: Alice={agentA}
Bob={agentB}
Eve={agentE}
asymEnc(NAK,1,1,2)=PUBKB
asymEnc(NK,1,1,1)=PUBKB
asymEnc(NNK,1,1,2)=PUBKA
internalStateA(agentA)=END_A
internalStateB(agentB)=END_B
knowsAsymPrivKey(agentA,PRIVKA)=true
knowsAsymPrivKey(agentB,PRIVKB)=true
knowsAsymPrivKey(agentE,PRIVKA)=false
knowsAsymPrivKey(agentE,PRIVKB)=false
knowsIdentityCertificate(agentB,ID_A)=true
knowsNonce(agentA,NA)=true
knowsNonce(agentA,NB)=true
knowsNonce(agentB,NA)=true
messageField(agentA,agentE,1,NAK)=NA
messageField(agentA,agentE,1,NK)=undef
messageField(agentA,agentE,2,NAK)=ID_A
messageField(agentB,agentE,1,NNK)=NA
messageField(agentB,agentE,2,NNK)=NB
messageField(agentE,agentA,1,NAK)=NA
messageField(agentE,agentA,2,NAK)=NB
messageField(agentE,agentA,2,NNK)=undef
messageField(agentE,agentB,1,NAK)=undef
messageField(agentE,agentB,2,NAK)=ID_A
mode=ACTIVE
protocolMessage(agentA,agentE)=NK
protocolMessage(agentB,agentE)=NNK
protocolMessage(agentE,agentA)=NNK
protocolMessage(agentE,agentB)=NK
receiver=AG_B
self=agentE
run terminated