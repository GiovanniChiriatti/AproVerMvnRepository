simulating Needham_SchroederNSSYM.asm
INFO - parsing file C:\Users\gioeg\AProVerDirectory\Aprover\src\main\resources\AProVerTest\Needham_SchroederNSSYM.asm
INFO - file successfully parsed for asm Needham_SchroederNSSYM
Running interactively Needham_SchroederNSSYM.asm
INITIAL STATE:Alice={agentA}
Bob={agentB}
Eve={agentE}
Server={agentS}
Insert a symbol of Receiver in [AG_A, AG_B, AG_E, AG_S] for chosenReceiver:
AG_E
Insert a symbol of Modality in [ACTIVE, PASSIVE] for chosenMode:
ACTIVE
<State 0 (monitored)>
chosenMode=ACTIVE
chosenReceiver=AG_E
</State 0 (monitored)>
<UpdateSet - 0>
internalStateA(agentA)=WAITING_MB
messageField(agentA,agentE,1,MA)=CA
messageField(agentA,agentE,2,MA)=CB
messageField(agentA,agentE,3,MA)=NA
protocolMessage(agentA,agentE)=MA
</UpdateSet>
<State 1 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
Server={agentS}
internalStateA(agentA)=WAITING_MB
internalStateB(agentB)=undef
internalStateS(agentS)=WAITING_MA
messageField(agentA,agentE,1,MA)=CA
messageField(agentA,agentE,2,MA)=CB
messageField(agentA,agentE,3,MA)=NA
mode=ACTIVE
protocolMessage(agentA,agentE)=MA
protocolMessage(agentB,agentE)=undef
protocolMessage(agentE,agentA)=undef
protocolMessage(agentE,agentB)=undef
protocolMessage(agentE,agentS)=undef
protocolMessage(agentS,agentE)=undef
receiver=AG_E
</State 1 (controlled)>
<UpdateSet - 1>
knowsIdentityCertificate(agentE,CA)=true
knowsIdentityCertificate(agentE,CB)=true
knowsNonce(agentE,NA)=true
messageField(agentE,agentS,1,MA)=CA
messageField(agentE,agentS,2,MA)=CB
messageField(agentE,agentS,3,MA)=NA
protocolMessage(agentE,agentS)=MA
</UpdateSet>
<State 2 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
Server={agentS}
internalStateA(agentA)=WAITING_MB
internalStateB(agentB)=undef
internalStateS(agentS)=WAITING_MA
knowsIdentityCertificate(agentE,CA)=true
knowsIdentityCertificate(agentE,CB)=true
knowsNonce(agentE,NA)=true
messageField(agentA,agentE,1,MA)=CA
messageField(agentA,agentE,2,MA)=CB
messageField(agentA,agentE,3,MA)=NA
messageField(agentE,agentS,1,MA)=CA
messageField(agentE,agentS,2,MA)=CB
messageField(agentE,agentS,3,MA)=NA
mode=ACTIVE
protocolMessage(agentA,agentE)=MA
protocolMessage(agentB,agentE)=undef
protocolMessage(agentE,agentA)=undef
protocolMessage(agentE,agentB)=undef
protocolMessage(agentE,agentS)=MA
protocolMessage(agentS,agentE)=undef
receiver=AG_E
</State 2 (controlled)>
<UpdateSet - 2>
internalStateB(agentS)=WAITING_MC
knowsIdentityCertificate(agentS,CA)=true
knowsIdentityCertificate(agentS,CB)=true
knowsNonce(agentS,NA)=true
messageField(agentS,agentE,1,MB)=NA
messageField(agentS,agentE,2,MB)=KEA
messageField(agentS,agentE,3,MB)=CB
messageField(agentS,agentE,4,MB)=undef
messageField(agentS,agentE,5,MB)=CA
protocolMessage(agentS,agentE)=MB
symEnc(MB,2,1,5)=KEA
</UpdateSet>
<State 3 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
Server={agentS}
internalStateA(agentA)=WAITING_MB
internalStateB(agentB)=undef
internalStateB(agentS)=WAITING_MC
internalStateS(agentS)=WAITING_MA
knowsIdentityCertificate(agentE,CA)=true
knowsIdentityCertificate(agentE,CB)=true
knowsIdentityCertificate(agentS,CA)=true
knowsIdentityCertificate(agentS,CB)=true
knowsNonce(agentE,NA)=true
knowsNonce(agentS,NA)=true
messageField(agentA,agentE,1,MA)=CA
messageField(agentA,agentE,2,MA)=CB
messageField(agentA,agentE,3,MA)=NA
messageField(agentE,agentS,1,MA)=CA
messageField(agentE,agentS,2,MA)=CB
messageField(agentE,agentS,2,MB)=undef
messageField(agentE,agentS,3,MA)=NA
messageField(agentS,agentE,1,MB)=NA
messageField(agentS,agentE,2,MB)=KEA
messageField(agentS,agentE,3,MB)=CB
messageField(agentS,agentE,4,MB)=undef
messageField(agentS,agentE,5,MB)=CA
mode=ACTIVE
protocolMessage(agentA,agentE)=MA
protocolMessage(agentB,agentE)=undef
protocolMessage(agentE,agentA)=undef
protocolMessage(agentE,agentB)=undef
protocolMessage(agentE,agentS)=MA
protocolMessage(agentS,agentE)=MB
receiver=AG_E
symEnc(MB,2,1,5)=KEA
</State 3 (controlled)>
<UpdateSet - 3>
internalStateB(agentS)=WAITING_MC
knowsIdentityCertificate(agentE,CA)=true
knowsIdentityCertificate(agentE,CB)=true
knowsIdentityCertificate(agentS,CA)=true
knowsIdentityCertificate(agentS,CB)=true
knowsNonce(agentE,NA)=true
knowsNonce(agentS,NA)=true
knowsSymKey(agentE,KEA)=true
knowsSymKey(agentE,undef)=true
messageField(agentE,agentA,1,MB)=NA
messageField(agentE,agentA,2,MB)=KEA
messageField(agentE,agentA,3,MB)=CB
messageField(agentE,agentA,4,MB)=KEA
messageField(agentE,agentA,5,MB)=CA
messageField(agentS,agentE,1,MB)=NA
messageField(agentS,agentE,2,MB)=KEA
messageField(agentS,agentE,3,MB)=CB
messageField(agentS,agentE,4,MB)=undef
messageField(agentS,agentE,5,MB)=CA
protocolMessage(agentE,agentA)=MB
protocolMessage(agentS,agentE)=MB
symEnc(MB,2,1,5)=KEA
</UpdateSet>
<State 4 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
Server={agentS}
internalStateA(agentA)=WAITING_MB
internalStateB(agentB)=undef
internalStateB(agentS)=WAITING_MC
internalStateS(agentS)=WAITING_MA
knowsIdentityCertificate(agentE,CA)=true
knowsIdentityCertificate(agentE,CB)=true
knowsIdentityCertificate(agentS,CA)=true
knowsIdentityCertificate(agentS,CB)=true
knowsNonce(agentE,NA)=true
knowsNonce(agentS,NA)=true
knowsSymKey(agentE,KEA)=true
knowsSymKey(agentE,undef)=true
messageField(agentA,agentE,1,MA)=CA
messageField(agentA,agentE,2,MA)=CB
messageField(agentA,agentE,3,MA)=NA
messageField(agentE,agentA,1,MB)=NA
messageField(agentE,agentA,2,MB)=KEA
messageField(agentE,agentA,3,MB)=CB
messageField(agentE,agentA,4,MB)=KEA
messageField(agentE,agentA,5,MB)=CA
messageField(agentE,agentS,1,MA)=CA
messageField(agentE,agentS,2,MA)=CB
messageField(agentE,agentS,2,MB)=undef
messageField(agentE,agentS,3,MA)=NA
messageField(agentS,agentE,1,MB)=NA
messageField(agentS,agentE,2,MB)=KEA
messageField(agentS,agentE,3,MB)=CB
messageField(agentS,agentE,4,MB)=undef
messageField(agentS,agentE,5,MB)=CA
mode=ACTIVE
protocolMessage(agentA,agentE)=MA
protocolMessage(agentB,agentE)=undef
protocolMessage(agentE,agentA)=MB
protocolMessage(agentE,agentB)=undef
protocolMessage(agentE,agentS)=MA
protocolMessage(agentS,agentE)=MB
receiver=AG_E
symEnc(MB,2,1,5)=KEA
</State 4 (controlled)>
<UpdateSet - 4>
internalStateB(agentS)=WAITING_MC
knowsIdentityCertificate(agentS,CA)=true
knowsIdentityCertificate(agentS,CB)=true
knowsNonce(agentS,NA)=true
messageField(agentS,agentE,1,MB)=NA
messageField(agentS,agentE,2,MB)=KEA
messageField(agentS,agentE,3,MB)=CB
messageField(agentS,agentE,4,MB)=undef
messageField(agentS,agentE,5,MB)=CA
protocolMessage(agentS,agentE)=MB
symEnc(MB,2,1,5)=KEA
</UpdateSet>
<State 5 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
Server={agentS}
internalStateA(agentA)=WAITING_MB
internalStateB(agentB)=undef
internalStateB(agentS)=WAITING_MC
internalStateS(agentS)=WAITING_MA
knowsIdentityCertificate(agentE,CA)=true
knowsIdentityCertificate(agentE,CB)=true
knowsIdentityCertificate(agentS,CA)=true
knowsIdentityCertificate(agentS,CB)=true
knowsNonce(agentE,NA)=true
knowsNonce(agentS,NA)=true
knowsSymKey(agentA,KEA)=false
knowsSymKey(agentE,KEA)=true
knowsSymKey(agentE,undef)=true
messageField(agentA,agentE,1,MA)=CA
messageField(agentA,agentE,2,MA)=CB
messageField(agentA,agentE,3,MA)=NA
messageField(agentE,agentA,1,MB)=NA
messageField(agentE,agentA,2,MB)=KEA
messageField(agentE,agentA,3,MB)=CB
messageField(agentE,agentA,4,MB)=KEA
messageField(agentE,agentA,5,MB)=CA
messageField(agentE,agentS,1,MA)=CA
messageField(agentE,agentS,2,MA)=CB
messageField(agentE,agentS,2,MB)=undef
messageField(agentE,agentS,3,MA)=NA
messageField(agentS,agentE,1,MB)=NA
messageField(agentS,agentE,2,MB)=KEA
messageField(agentS,agentE,3,MB)=CB
messageField(agentS,agentE,4,MB)=undef
messageField(agentS,agentE,5,MB)=CA
mode=ACTIVE
protocolMessage(agentA,agentE)=MA
protocolMessage(agentB,agentE)=undef
protocolMessage(agentE,agentA)=MB
protocolMessage(agentE,agentB)=undef
protocolMessage(agentE,agentS)=MA
protocolMessage(agentS,agentE)=MB
receiver=AG_E
symEnc(MB,2,1,5)=KEA
</State 5 (controlled)>
FINAL STATE: Alice={agentA}
Bob={agentB}
Eve={agentE}
Server={agentS}
internalStateA(agentA)=WAITING_MB
internalStateB(agentB)=undef
internalStateB(agentS)=WAITING_MC
internalStateS(agentS)=WAITING_MA
knowsIdentityCertificate(agentE,CA)=true
knowsIdentityCertificate(agentE,CB)=true
knowsIdentityCertificate(agentS,CA)=true
knowsIdentityCertificate(agentS,CB)=true
knowsNonce(agentE,NA)=true
knowsNonce(agentS,NA)=true
knowsSymKey(agentA,KEA)=false
knowsSymKey(agentE,KEA)=true
knowsSymKey(agentE,undef)=true
messageField(agentA,agentE,1,MA)=CA
messageField(agentA,agentE,2,MA)=CB
messageField(agentA,agentE,3,MA)=NA
messageField(agentE,agentA,1,MB)=NA
messageField(agentE,agentA,2,MB)=KEA
messageField(agentE,agentA,3,MB)=CB
messageField(agentE,agentA,4,MB)=KEA
messageField(agentE,agentA,5,MB)=CA
messageField(agentE,agentS,1,MA)=CA
messageField(agentE,agentS,2,MA)=CB
messageField(agentE,agentS,2,MB)=undef
messageField(agentE,agentS,3,MA)=NA
messageField(agentS,agentE,1,MB)=NA
messageField(agentS,agentE,2,MB)=KEA
messageField(agentS,agentE,3,MB)=CB
messageField(agentS,agentE,4,MB)=undef
messageField(agentS,agentE,5,MB)=CA
mode=ACTIVE
protocolMessage(agentA,agentE)=MA
protocolMessage(agentB,agentE)=undef
protocolMessage(agentE,agentA)=MB
protocolMessage(agentE,agentB)=undef
protocolMessage(agentE,agentS)=MA
protocolMessage(agentS,agentE)=MB
receiver=AG_E
self=agentE
symEnc(MB,2,1,5)=KEA
run terminated