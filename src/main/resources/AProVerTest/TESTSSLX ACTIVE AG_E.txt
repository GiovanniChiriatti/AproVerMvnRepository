simulating SSLX.asm
INFO - parsing file C:\Users\gioeg\AProVerDirectory\Aprover\src\main\resources\AProVerTest\SSLX.asm
INFO - file successfully parsed for asm SSLX
Running interactively SSLX.asm
INITIAL STATE:Alice={agentA}
Bob={agentB}
Eve={agentE}
Insert a symbol of Receiver in [AG_A, AG_B, AG_E] for chosenReceiver:
AG_E
Insert a symbol of Modality in [ACTIVE, PASSIVE] for chosenMode:
ACTIVE
<State 0 (monitored)>
chosenMode=ACTIVE
chosenReceiver=AG_E
</State 0 (monitored)>
<UpdateSet - 0>
asymEnc(KK,1,1,1)=PUBKE
internalStateA(agentA)=WAITING_NK
messageField(agentA,agentE,1,KK)=SKAE
protocolMessage(agentA,agentE)=KK
</UpdateSet>
<State 1 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
asymEnc(KK,1,1,1)=PUBKE
internalStateA(agentA)=WAITING_NK
internalStateB(agentB)=WAITING_KK
messageField(agentA,agentE,1,KK)=SKAE
mode=ACTIVE
protocolMessage(agentA,agentE)=KK
protocolMessage(agentB,agentE)=undef
protocolMessage(agentE,agentA)=undef
protocolMessage(agentE,agentB)=undef
receiver=AG_E
</State 1 (controlled)>
<UpdateSet - 1>
asymEnc(KK,1,1,1)=PUBKB
knowsSymKey(agentE,SKAE)=true
messageField(agentE,agentB,1,KK)=SKEB
protocolMessage(agentE,agentB)=KK
</UpdateSet>
<State 2 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
asymEnc(KK,1,1,1)=PUBKB
internalStateA(agentA)=WAITING_NK
internalStateB(agentB)=WAITING_KK
knowsAsymPrivKey(agentE,PRIVKE)=true
knowsSymKey(agentE,SKAE)=true
messageField(agentA,agentE,1,KK)=SKAE
messageField(agentE,agentB,1,KK)=SKEB
mode=ACTIVE
protocolMessage(agentA,agentE)=KK
protocolMessage(agentB,agentE)=undef
protocolMessage(agentE,agentA)=undef
protocolMessage(agentE,agentB)=KK
receiver=AG_E
</State 2 (controlled)>
<UpdateSet - 2>
internalStateB(agentB)=WAITING_CSNK
knowsSymKey(agentB,SKEB)=true
messageField(agentB,agentE,1,NK)=NB
protocolMessage(agentB,agentE)=NK
symEnc(NK,1,1,1)=SKEB
</UpdateSet>
<State 3 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
asymEnc(KK,1,1,1)=PUBKB
internalStateA(agentA)=WAITING_NK
internalStateB(agentB)=WAITING_CSNK
knowsAsymPrivKey(agentB,PRIVKB)=true
knowsAsymPrivKey(agentE,PRIVKE)=true
knowsSymKey(agentB,SKEB)=true
knowsSymKey(agentE,SKAE)=true
messageField(agentA,agentE,1,KK)=SKAE
messageField(agentB,agentE,1,NK)=NB
messageField(agentE,agentB,1,KK)=SKEB
mode=ACTIVE
protocolMessage(agentA,agentE)=KK
protocolMessage(agentB,agentE)=NK
protocolMessage(agentE,agentA)=undef
protocolMessage(agentE,agentB)=KK
receiver=AG_E
symEnc(NK,1,1,1)=SKEB
</State 3 (controlled)>
<UpdateSet - 3>
knowsNonce(agentE,NB)=true
messageField(agentE,agentA,1,NK)=NB
protocolMessage(agentE,agentA)=NK
symEnc(NK,1,1,1)=SKAE
</UpdateSet>
<State 4 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
asymEnc(KK,1,1,1)=PUBKB
internalStateA(agentA)=WAITING_NK
internalStateB(agentB)=WAITING_CSNK
knowsAsymPrivKey(agentB,PRIVKB)=true
knowsAsymPrivKey(agentE,PRIVKE)=true
knowsNonce(agentE,NB)=true
knowsSymKey(agentB,SKEB)=true
knowsSymKey(agentE,SKAE)=true
knowsSymKey(agentE,SKEB)=true
messageField(agentA,agentE,1,KK)=SKAE
messageField(agentB,agentE,1,NK)=NB
messageField(agentE,agentA,1,NK)=NB
messageField(agentE,agentB,1,KK)=SKEB
mode=ACTIVE
protocolMessage(agentA,agentE)=KK
protocolMessage(agentB,agentE)=NK
protocolMessage(agentE,agentA)=NK
protocolMessage(agentE,agentB)=KK
receiver=AG_E
symEnc(NK,1,1,1)=SKAE
</State 4 (controlled)>
<UpdateSet - 4>
internalStateA(agentA)=END_A
knowsNonce(agentA,undef)=true
messageField(agentA,agentE,1,CSNK)=CA
messageField(agentA,agentE,2,CSNK)=NB
protocolMessage(agentA,agentE)=CSNK
sign(CSNK,1,2,2)=SIGNPRIVKA
symEnc(CSNK,2,1,2)=SKAE
</UpdateSet>
<State 5 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
asymEnc(KK,1,1,1)=PUBKB
internalStateA(agentA)=END_A
internalStateB(agentB)=WAITING_CSNK
knowsAsymPrivKey(agentB,PRIVKB)=true
knowsAsymPrivKey(agentE,PRIVKE)=true
knowsNonce(agentA,undef)=true
knowsNonce(agentE,NB)=true
knowsSymKey(agentA,SKAE)=true
knowsSymKey(agentB,SKEB)=true
knowsSymKey(agentE,SKAE)=true
knowsSymKey(agentE,SKEB)=true
messageField(agentA,agentE,1,CSNK)=CA
messageField(agentA,agentE,1,KK)=SKAE
messageField(agentA,agentE,2,CSNK)=NB
messageField(agentB,agentE,1,NK)=NB
messageField(agentE,agentA,1,KK)=undef
messageField(agentE,agentA,1,NK)=NB
messageField(agentE,agentB,1,KK)=SKEB
mode=ACTIVE
protocolMessage(agentA,agentE)=CSNK
protocolMessage(agentB,agentE)=NK
protocolMessage(agentE,agentA)=NK
protocolMessage(agentE,agentB)=KK
receiver=AG_E
sign(CSNK,1,2,2)=SIGNPRIVKA
symEnc(CSNK,2,1,2)=SKAE
symEnc(NK,1,1,1)=SKAE
</State 5 (controlled)>
<UpdateSet - 5>
knowsIdentityCertificate(agentE,CA)=true
knowsNonce(agentE,NB)=true
messageField(agentE,agentB,1,CSNK)=CA
messageField(agentE,agentB,2,CSNK)=NB
protocolMessage(agentE,agentB)=CSNK
symEnc(CSNK,2,1,2)=SKEB
</UpdateSet>
<State 6 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
asymEnc(KK,1,1,1)=PUBKB
internalStateA(agentA)=END_A
internalStateB(agentB)=WAITING_CSNK
knowsAsymPrivKey(agentB,PRIVKB)=true
knowsAsymPrivKey(agentE,PRIVKE)=true
knowsIdentityCertificate(agentE,CA)=true
knowsNonce(agentA,undef)=true
knowsNonce(agentE,NB)=true
knowsSymKey(agentA,SKAE)=true
knowsSymKey(agentB,SKEB)=true
knowsSymKey(agentE,SKAE)=true
knowsSymKey(agentE,SKEB)=true
messageField(agentA,agentE,1,CSNK)=CA
messageField(agentA,agentE,1,KK)=SKAE
messageField(agentA,agentE,2,CSNK)=NB
messageField(agentB,agentE,1,NK)=NB
messageField(agentE,agentA,1,KK)=undef
messageField(agentE,agentA,1,NK)=NB
messageField(agentE,agentB,1,CSNK)=CA
messageField(agentE,agentB,1,KK)=SKEB
messageField(agentE,agentB,2,CSNK)=NB
mode=ACTIVE
protocolMessage(agentA,agentE)=CSNK
protocolMessage(agentB,agentE)=NK
protocolMessage(agentE,agentA)=NK
protocolMessage(agentE,agentB)=CSNK
receiver=AG_E
sign(CSNK,1,2,2)=SIGNPRIVKA
symEnc(CSNK,2,1,2)=SKEB
symEnc(NK,1,1,1)=SKAE
</State 6 (controlled)>
<UpdateSet - 6>
</UpdateSet>
<State 7 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
asymEnc(KK,1,1,1)=PUBKB
internalStateA(agentA)=END_A
internalStateB(agentB)=WAITING_CSNK
knowsAsymPrivKey(agentB,PRIVKB)=true
knowsAsymPrivKey(agentE,PRIVKE)=true
knowsIdentityCertificate(agentE,CA)=true
knowsNonce(agentA,undef)=true
knowsNonce(agentE,NB)=true
knowsSignPubKey(agentB,SIGNPUBKA)=false
knowsSymKey(agentA,SKAE)=true
knowsSymKey(agentB,SKEB)=true
knowsSymKey(agentE,SKAE)=true
knowsSymKey(agentE,SKEB)=true
messageField(agentA,agentE,1,CSNK)=CA
messageField(agentA,agentE,1,KK)=SKAE
messageField(agentA,agentE,2,CSNK)=NB
messageField(agentB,agentE,1,NK)=NB
messageField(agentE,agentA,1,KK)=undef
messageField(agentE,agentA,1,NK)=NB
messageField(agentE,agentB,1,CSNK)=CA
messageField(agentE,agentB,1,KK)=SKEB
messageField(agentE,agentB,2,CSNK)=NB
mode=ACTIVE
protocolMessage(agentA,agentE)=CSNK
protocolMessage(agentB,agentE)=NK
protocolMessage(agentE,agentA)=NK
protocolMessage(agentE,agentB)=CSNK
receiver=AG_E
sign(CSNK,1,2,2)=SIGNPRIVKA
symEnc(CSNK,2,1,2)=SKEB
symEnc(NK,1,1,1)=SKAE
</State 7 (controlled)>
FINAL STATE: Alice={agentA}
Bob={agentB}
Eve={agentE}
asymEnc(KK,1,1,1)=PUBKB
internalStateA(agentA)=END_A
internalStateB(agentB)=WAITING_CSNK
knowsAsymPrivKey(agentB,PRIVKB)=true
knowsAsymPrivKey(agentE,PRIVKE)=true
knowsIdentityCertificate(agentE,CA)=true
knowsNonce(agentA,undef)=true
knowsNonce(agentE,NB)=true
knowsSignPubKey(agentB,SIGNPUBKA)=false
knowsSymKey(agentA,SKAE)=true
knowsSymKey(agentB,SKEB)=true
knowsSymKey(agentE,SKAE)=true
knowsSymKey(agentE,SKEB)=true
messageField(agentA,agentE,1,CSNK)=CA
messageField(agentA,agentE,1,KK)=SKAE
messageField(agentA,agentE,2,CSNK)=NB
messageField(agentB,agentE,1,NK)=NB
messageField(agentE,agentA,1,KK)=undef
messageField(agentE,agentA,1,NK)=NB
messageField(agentE,agentB,1,CSNK)=CA
messageField(agentE,agentB,1,KK)=SKEB
messageField(agentE,agentB,2,CSNK)=NB
mode=ACTIVE
protocolMessage(agentA,agentE)=CSNK
protocolMessage(agentB,agentE)=NK
protocolMessage(agentE,agentA)=NK
protocolMessage(agentE,agentB)=CSNK
receiver=AG_E
self=agentE
sign(CSNK,1,2,2)=SIGNPRIVKA
symEnc(CSNK,2,1,2)=SKEB
symEnc(NK,1,1,1)=SKAE
run terminated