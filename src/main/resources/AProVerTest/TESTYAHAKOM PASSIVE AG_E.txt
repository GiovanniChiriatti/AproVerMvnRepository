simulating YAHALOM.asm
INFO - parsing file C:\Users\gioeg\AProVerDirectory\Aprover\src\main\resources\AProVerTest\YAHALOM.asm
INFO - file successfully parsed for asm YAHALOM
Running interactively YAHALOM.asm
INITIAL STATE:Alice={agentA}
Bob={agentB}
Eve={agentE}
Server={agentS}
Insert a symbol of Receiver in [AG_A, AG_B, AG_E, AG_S] for chosenReceiver:
AG_E
Insert a symbol of Modality in [ACTIVE, PASSIVE] for chosenMode:
PASSIVE
<State 0 (monitored)>
chosenMode=PASSIVE
chosenReceiver=AG_E
</State 0 (monitored)>
<UpdateSet - 0>
internalStateS(agentS)=WAITING_ENCKBS
messageField(agentA,agentE,1,REQCOM)=CA
messageField(agentA,agentE,2,REQCOM)=NA
protocolMessage(agentA,agentE)=REQCOM
</UpdateSet>
<State 1 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
Server={agentS}
internalStateA(agentA)=IDLE_REQCOM
internalStateB(agentB)=WAITING_REQCOM
internalStateS(agentS)=WAITING_ENCKBS
messageField(agentA,agentE,1,REQCOM)=CA
messageField(agentA,agentE,2,REQCOM)=NA
mode=PASSIVE
protocolMessage(agentA,agentE)=REQCOM
protocolMessage(agentB,agentE)=undef
protocolMessage(agentE,agentA)=undef
protocolMessage(agentE,agentB)=undef
protocolMessage(agentE,agentS)=undef
protocolMessage(agentS,agentE)=undef
receiver=AG_E
</State 1 (controlled)>
<UpdateSet - 1>
internalStateS(agentS)=WAITING_ENCKBS
knowsIdentityCertificate(agentE,CA)=true
knowsNonce(agentE,NA)=true
messageField(agentA,agentE,1,REQCOM)=CA
messageField(agentA,agentE,2,REQCOM)=NA
messageField(agentE,agentB,1,REQCOM)=CA
messageField(agentE,agentB,2,REQCOM)=NA
protocolMessage(agentA,agentE)=REQCOM
protocolMessage(agentE,agentB)=REQCOM
</UpdateSet>
<State 2 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
Server={agentS}
internalStateA(agentA)=IDLE_REQCOM
internalStateB(agentB)=WAITING_REQCOM
internalStateS(agentS)=WAITING_ENCKBS
knowsIdentityCertificate(agentE,CA)=true
knowsNonce(agentE,NA)=true
messageField(agentA,agentE,1,REQCOM)=CA
messageField(agentA,agentE,2,REQCOM)=NA
messageField(agentE,agentB,1,REQCOM)=CA
messageField(agentE,agentB,2,REQCOM)=NA
mode=PASSIVE
protocolMessage(agentA,agentE)=REQCOM
protocolMessage(agentB,agentE)=undef
protocolMessage(agentE,agentA)=undef
protocolMessage(agentE,agentB)=REQCOM
protocolMessage(agentE,agentS)=undef
protocolMessage(agentS,agentE)=undef
receiver=AG_E
</State 2 (controlled)>
<UpdateSet - 2>
internalStateA(agentA)=WAITING_GENKEYSES
internalStateS(agentS)=WAITING_ENCKBS
knowsIdentityCertificate(agentB,CA)=true
knowsNonce(agentB,NA)=true
messageField(agentA,agentE,1,REQCOM)=CA
messageField(agentA,agentE,2,REQCOM)=NA
messageField(agentB,agentE,1,ENCKBS)=CB
messageField(agentB,agentE,2,ENCKBS)=CA
messageField(agentB,agentE,3,ENCKBS)=NA
messageField(agentB,agentE,4,ENCKBS)=NB
protocolMessage(agentA,agentE)=REQCOM
protocolMessage(agentB,agentE)=ENCKBS
symEnc(ENCKBS,1,2,4)=KES
</UpdateSet>
<State 3 (controlled)>
Alice={agentA}
Bob={agentB}
Eve={agentE}
Server={agentS}
internalStateA(agentA)=WAITING_GENKEYSES
internalStateB(agentB)=WAITING_REQCOM
internalStateS(agentS)=WAITING_ENCKBS
knowsIdentityCertificate(agentB,CA)=true
knowsIdentityCertificate(agentE,CA)=true
knowsNonce(agentB,NA)=true
knowsNonce(agentE,NA)=true
messageField(agentA,agentE,1,REQCOM)=CA
messageField(agentA,agentE,2,REQCOM)=NA
messageField(agentB,agentE,1,ENCKBS)=CB
messageField(agentB,agentE,2,ENCKBS)=CA
messageField(agentB,agentE,3,ENCKBS)=NA
messageField(agentB,agentE,4,ENCKBS)=NB
messageField(agentE,agentB,1,REQCOM)=CA
messageField(agentE,agentB,2,REQCOM)=NA
mode=PASSIVE
protocolMessage(agentA,agentE)=REQCOM
protocolMessage(agentB,agentE)=ENCKBS
protocolMessage(agentE,agentA)=undef
protocolMessage(agentE,agentB)=REQCOM
protocolMessage(agentE,agentS)=undef
protocolMessage(agentS,agentE)=undef
receiver=AG_E
symEnc(ENCKBS,1,2,4)=KES
</State 3 (controlled)>
INCONSISTENT UPDATE FOUND !!! : location symEnc(ENCKBS,1,2,4)
 updated to KES != KBS
FINAL STATE: Alice={agentA}
Bob={agentB}
Eve={agentE}
Server={agentS}
internalStateA(agentA)=WAITING_GENKEYSES
internalStateB(agentB)=WAITING_REQCOM
internalStateS(agentS)=WAITING_ENCKBS
knowsIdentityCertificate(agentB,CA)=true
knowsIdentityCertificate(agentE,CA)=true
knowsNonce(agentB,NA)=true
knowsNonce(agentE,NA)=true
knowsSymKey(agentE,KES)=true
messageField(agentA,agentE,1,REQCOM)=CA
messageField(agentA,agentE,2,REQCOM)=NA
messageField(agentB,agentE,1,ENCKBS)=CB
messageField(agentB,agentE,2,ENCKBS)=CA
messageField(agentB,agentE,3,ENCKBS)=NA
messageField(agentB,agentE,4,ENCKBS)=NB
messageField(agentE,agentB,1,REQCOM)=CA
messageField(agentE,agentB,2,REQCOM)=NA
mode=PASSIVE
protocolMessage(agentA,agentE)=REQCOM
protocolMessage(agentB,agentE)=ENCKBS
protocolMessage(agentE,agentA)=undef
protocolMessage(agentE,agentB)=REQCOM
protocolMessage(agentE,agentS)=undef
protocolMessage(agentS,agentE)=undef
receiver=AG_E
self=agentE
symEnc(ENCKBS,1,2,4)=KES
run terminated